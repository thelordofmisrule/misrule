<section id="isso-thread"></section>

<script
  data-isso="https://comments.misrule.me/"
  src="https://comments.misrule.me/js/embed.min.js">
</script>

<style>
/* Keep original thread width */
#isso-thread {
  max-width: 100%;
}

/* Hide ALL optional text */
#isso-thread .optional {
  display: none !important;
}

/* Red asterisk for required fields */
#isso-thread label[for="isso-postbox-author"]:after,
#isso-thread label[for="isso-postbox-email"]:after {
  content: " *";
  color: #c00;
}

/* --- CSS FOR INPUT FIELD AND BUTTON SPACING (Desktop Focus) --- */

/* Main container for the row of inputs and buttons */
#isso-thread .isso-postbox-footer {
  display: flex;
  flex-wrap: wrap; /* Allow wrapping on smaller screens */
  align-items: flex-end; /* Align items based on their bottom edge, good for buttons and inputs */
  margin-bottom: 1em;
  gap: 1.5em; /* Default gap between auth section and buttons section */
}

/* The section containing Name, Email, (Website) fields */
#isso-thread .isso-auth-section {
  display: flex;
  flex-grow: 2; /* This section will try to take up 2/3 of the available space */
  flex-basis: 0; /* Essential for proper flex-grow distribution */
  /* flex-wrap: nowrap; /* Generally keep auth fields on one line */
  gap: 1.5em; /* Spacing BETWEEN input field wrappers (Author, Email) */
}

/* Individual input field wrappers (e.g., for author, email) */
#isso-thread .isso-auth-section > div,
#isso-thread .isso-auth-section > p {
  flex-grow: 1; /* Each field will grow equally within .isso-auth-section */
  flex-basis: 0; /* Distribute space evenly initially */
  min-width: 150px; /* Adjust if necessary, prevents fields from becoming too narrow */
}

/* Style the labels within the auth section */
#isso-thread .isso-auth-section label {
  display: block;
  margin-bottom: 0.3em;
  font-size: 0.9em;
  line-height: 1.2; /* Added for consistent spacing */
}

/* Style the input elements themselves */
#isso-thread .isso-auth-section input[type="text"],
#isso-thread .isso-auth-section input[type="email"],
#isso-thread .isso-auth-section input[type="url"] {
  padding: 8px 10px;
  border: 1px solid #ccc;
  border-radius: 3px;
  width: 100%; /* Make input take full width of its parent (the p or div) */
  box-sizing: border-box;
  font-size: 1em; /* Ensure consistent font size with buttons */
}

/* The section for Post and Preview buttons */
#isso-thread .isso-post-action {
  display: flex;
  flex-grow: 1; /* This section will try to take up 1/3 of the available space */
  flex-basis: 0; /* Essential for proper flex-grow distribution */
  align-items: center; /* Vertically align buttons if they have different heights */
  justify-content: flex-start; /* Align buttons to the start of this flex container */
  gap: 1em; /* Space between buttons */
  /* padding-top: 0; /* Removed specific padding-top, relying on align-items: flex-end on parent */
}

/* Ensure buttons have a consistent height matching inputs if possible */
#isso-thread .isso-post-action input[type="submit"],
#isso-thread .isso-post-action button {
    padding: 8px 12px; /* Match input padding for better vertical alignment */
    font-size: 1em; /* Match input font size */
    line-height: 1.5; /* Adjust as needed to match input height */
    border: 1px solid #ccc; /* Example border, style as needed */
    border-radius: 3px;
    cursor: pointer;
}


/* Ensure textarea stays full width and below other inputs */
#isso-thread .isso-textarea-wrapper {
  /* clear: both; /* May not be needed with flex-wrap on parent */
  padding-top: 0.5em;
  width: 100%; /* Ensure it takes full width after wrapping */
}

#isso-thread .isso-textarea-wrapper textarea {
  width: 100%;
  box-sizing: border-box;
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 3px;
}
</style>

<script>
function removeOptionalTextAndSetPlaceholder() {
  var elements = document.querySelectorAll('#isso-thread *');
  elements.forEach(function(el) {
    for (var i = 0; i < el.childNodes.length; i++) {
      var node = el.childNodes[i];
      if (node.nodeType === 3 && node.textContent.includes('(optional)')) {
        node.textContent = node.textContent.replace(/\s*\(optional\)\s*/g, '');
      }
    }
  });
  var optionalSpans = document.querySelectorAll('#isso-thread .optional');
  optionalSpans.forEach(function(span) {
    span.style.display = 'none';
  });
  var emailInput = document.querySelector('#isso-thread input[type="email"]#isso-postbox-email');
  if (emailInput && emailInput.placeholder.toLowerCase().includes('email')) {
    emailInput.placeholder = 'jdoe@example.com (optional, for gravatar/notifications)';
  }
  var authorInput = document.querySelector('#isso-thread input[type="text"]#isso-postbox-author');
  if (authorInput && authorInput.placeholder.toLowerCase().includes('name')) {
     authorInput.placeholder = 'Name';
  }
}
window.addEventListener('load', function() {
  var issoThread = document.getElementById('isso-thread');
  if (issoThread) {
    setTimeout(removeOptionalTextAndSetPlaceholder, 500);
    setTimeout(removeOptionalTextAndSetPlaceholder, 1500);
    var observer = new MutationObserver(function(mutations) {
      removeOptionalTextAndSetPlaceholder();
    });
    observer.observe(issoThread, { childList: true, subtree: true });
  }
});
</script>